<!-- @format -->

# –°–±–æ—Ä Proof —Å —É–∑–ª–æ–≤ Aztec

–≠—Ç–æ—Ç –ø–ª–µ–π–±—É–∫ –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –∫–æ –≤—Å–µ–º —Å–µ—Ä–≤–µ—Ä–∞–º –∏–∑ inventory —Ñ–∞–π–ª–∞ –∏ —Å–æ–±–∏—Ä–∞–µ—Ç proof –¥–∞–Ω–Ω—ã–µ —Å –∫–∞–∂–¥–æ–≥–æ —É–∑–ª–∞ Aztec.

## –û–ø–∏—Å–∞–Ω–∏–µ

–ü–ª–µ–π–±—É–∫ –≤—ã–ø–æ–ª–Ω—è–µ—Ç —Å–ª–µ–¥—É—é—â–∏–µ –¥–µ–π—Å—Ç–≤–∏—è:

1. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π inventory —Ñ–∞–π–ª —Å —Å–µ—Ä–≤–µ—Ä–∞–º–∏
2. –ü–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –∫ –∫–∞–∂–¥–æ–º—É —Å–µ—Ä–≤–µ—Ä—É –∏–∑ —Å–ø–∏—Å–∫–∞
3. –í—ã–ø–æ–ª–Ω—è–µ—Ç –∫–æ–º–∞–Ω–¥—É GetProof.sh –Ω–∞ –∫–∞–∂–¥–æ–º —Å–µ—Ä–≤–µ—Ä–µ
4. –ü–∞—Ä—Å–∏—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç –¥–ª—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è –Ω–æ–º–µ—Ä–∞ –±–ª–æ–∫–∞ –∏ proof
5. –°–æ—Ö—Ä–∞–Ω—è–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤ CSV —Ñ–∞–π–ª —Å –¥–µ—Ç–∞–ª—å–Ω–æ–π –∞–Ω–∞–ª–∏—Ç–∏–∫–æ–π

## üöÄ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –ü—Ä–æ—Å—Ç–æ–π –∑–∞–ø—É—Å–∫

```bash
cd aztec_ansible/get_proof_playbook
./run_get_proof.sh
```

### –° –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–º–∏ –æ–ø—Ü–∏—è–º–∏

```bash
# –ü–æ–¥—Ä–æ–±–Ω—ã–π –≤—ã–≤–æ–¥
VERBOSE=1 ./run_get_proof.sh

# –£–≤–µ–ª–∏—á–µ–Ω–Ω—ã–π —Ç–∞–π–º–∞—É—Ç (10 –º–∏–Ω—É—Ç)
TIMEOUT=600 ./run_get_proof.sh

# –°–ø—Ä–∞–≤–∫–∞
./run_get_proof.sh --help
```

### –ó–∞–ø—É—Å–∫ –∏–∑ –∫–æ—Ä–Ω—è –ø—Ä–æ–µ–∫—Ç–∞

```bash
# –ü—Ä–æ—Å—Ç–æ–π –∑–∞–ø—É—Å–∫
bash aztec_ansible/get_proof_playbook/run_get_proof.sh

# –° –æ–ø—Ü–∏—è–º–∏
VERBOSE=1 bash aztec_ansible/get_proof_playbook/run_get_proof.sh
```

## üìã –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

1. **Inventory —Ñ–∞–π–ª**: –î–æ–ª–∂–µ–Ω —Å—É—â–µ—Å—Ç–≤–æ–≤–∞—Ç—å `../common/inventory/hosts`
2. **SSH –∫–ª—é—á**: –î–æ–ª–∂–µ–Ω –±—ã—Ç—å –¥–æ—Å—Ç—É–ø–µ–Ω `../common/ssh/id_rsa` (–ø—Ä–∞–≤–∞ 600)
3. **–ü–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω–Ω—ã–µ —Å–µ—Ä–≤–µ—Ä—ã**: –°–µ—Ä–≤–µ—Ä—ã –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω—ã —á–µ—Ä–µ–∑ —É—Å—Ç–∞–Ω–æ–≤–æ—á–Ω—ã–µ —Å–∫—Ä–∏–ø—Ç—ã

### –ï—Å–ª–∏ inventory —Ñ–∞–π–ª–∞ –Ω–µ—Ç

```bash
# –°–Ω–∞—á–∞–ª–∞ –ø–æ–¥–≥–æ—Ç–æ–≤—å—Ç–µ —Å–µ—Ä–≤–µ—Ä—ã
cd ../install_playbook
./run_01_prepare.sh path/to/your/servers.csv

# –ó–∞—Ç–µ–º –∑–∞–ø—É—Å—Ç–∏—Ç–µ —Å–±–æ—Ä proof
cd ../get_proof_playbook
./run_get_proof.sh
```

## üìä –†–µ–∑—É–ª—å—Ç–∞—Ç

–°–æ–∑–¥–∞–µ—Ç—Å—è —Ñ–∞–π–ª `proof_results.csv` —Å–æ —Å–ª–µ–¥—É—é—â–µ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π:

```
ip,address,block_number,proof,status,timestamp
95.216.84.227,0x123...abc,12345,0xabcd...,SUCCESS,2024-01-15T10:30:00Z
95.216.84.228,0x456...def,ERROR,ERROR,FAILED,2024-01-15T10:30:15Z
```

### –°—Ç–æ–ª–±—Ü—ã —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞

- `ip` - IP-–∞–¥—Ä–µ—Å —Å–µ—Ä–≤–µ—Ä–∞
- `address` - Ethereum –∞–¥—Ä–µ—Å —Å–µ—Ä–≤–µ—Ä–∞ (–∏–∑ inventory)
- `block_number` - –ù–æ–º–µ—Ä –±–ª–æ–∫–∞ –∏–∑ GetProof.sh
- `proof` - Proof –¥–∞–Ω–Ω—ã–µ –∏–∑ GetProof.sh
- `status` - –°—Ç–∞—Ç—É—Å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è (SUCCESS/ERROR/FAILED)
- `timestamp` - –í—Ä–µ–º—è —Å–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö

### –ê–Ω–∞–ª–∏–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

–°–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç:

- –û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–µ—Ä–≤–µ—Ä–æ–≤
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —É—Å–ø–µ—à–Ω—ã—Ö —Å–±–æ—Ä–æ–≤
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—à–∏–±–æ–∫
- –ü—Ä–æ—Ü–µ–Ω—Ç —É—Å–ø–µ—à–Ω–æ—Å—Ç–∏
- –ü—Ä–∏–º–µ—Ä—ã —É—Å–ø–µ—à–Ω—ã—Ö –∏ –Ω–µ—É–¥–∞—á–Ω—ã—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

### –§–∞–π–ª—ã –ª–æ–≥–æ–≤

```bash
# –û—Å–Ω–æ–≤–Ω–æ–π –ª–æ–≥
../logs/proof_collection_YYYYMMDD_HHMMSS.log

# –°–≤–æ–¥–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
../logs/proof_summary_YYYYMMDD_HHMMSS.txt

# –†–µ–∑–µ—Ä–≤–Ω—ã–µ –∫–æ–ø–∏–∏ –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
proof_results.csv.backup.YYYYMMDD_HHMMSS
```

## üîß –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

- **–ù–µ–¥–æ—Å—Ç—É–ø–Ω—ã–π —Å–µ—Ä–≤–µ—Ä**: –°—Ç–∞—Ç—É—Å "FAILED", –≤—Å–µ –ø–æ–ª—è —Å–æ–¥–µ—Ä–∂–∞—Ç "ERROR"
- **–û—à–∏–±–∫–∞ GetProof.sh**: –°—Ç–∞—Ç—É—Å "ERROR", —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è —Ç–µ–∫—Å—Ç –æ—à–∏–±–∫–∏
- **–¢–∞–π–º–∞—É—Ç**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–æ–≤—Ç–æ—Ä –¥–æ 2 —Ä–∞–∑ —Å –∑–∞–¥–µ—Ä–∂–∫–æ–π 30 —Å–µ–∫—É–Ω–¥
- **–ß–∞—Å—Ç–∏—á–Ω—ã–µ –æ—à–∏–±–∫–∏**: –ü–ª–µ–π–±—É–∫ –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç —Ä–∞–±–æ—Ç—É –∏ –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç —á–∞—Å—Ç–∏—á–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

## ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

- `VERBOSE=1` - –í–∫–ª—é—á–∞–µ—Ç –ø–æ–¥—Ä–æ–±–Ω—ã–π –≤—ã–≤–æ–¥ Ansible –∏ –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—É—é –ø—Ä–æ–≤–µ—Ä–∫—É –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π
- `TIMEOUT=300` - –¢–∞–π–º–∞—É—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è GetProof.sh (—Å–µ–∫—É–Ω–¥—ã, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 300)

### –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –≤ playbook

- `proof_timeout: 300` - –¢–∞–π–º–∞—É—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Å–∫—Ä–∏–ø—Ç–∞ (5 –º–∏–Ω—É—Ç)
- `max_retries: 2` - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–≤—Ç–æ—Ä–æ–≤ –ø—Ä–∏ –æ—à–∏–±–∫–µ
- `delay: 30` - –ó–∞–¥–µ—Ä–∂–∫–∞ –º–µ–∂–¥—É –ø–æ–≤—Ç–æ—Ä–∞–º–∏ (—Å–µ–∫—É–Ω–¥—ã)

## üìà –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

```bash
# –°–ª–µ–¥–∏—Ç—å –∑–∞ –ª–æ–≥–æ–º –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
tail -f ../logs/proof_collection_*.log

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
head proof_results.csv

# –°–ª–µ–¥–∏—Ç—å –∑–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ–º
watch -n 5 "wc -l proof_results.csv"
```

## üö® –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### "Inventory file not found"

```bash
cd ../install_playbook
./run_01_prepare.sh path/to/your/servers.csv
```

### "SSH key not found"

```bash
cp /path/to/your/key ../common/ssh/id_rsa
chmod 600 ../common/ssh/id_rsa
```

### "Some servers not reachable"

–ü—Ä–æ–≤–µ—Ä—å—Ç–µ SSH –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∏ —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Å–µ—Ä–≤–µ—Ä—ã –¥–æ—Å—Ç—É–ø–Ω—ã:

```bash
ansible all -i ../common/inventory/hosts -m ping
```

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è

- [–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏](../install_playbook/README.md)
- [–û–±—â–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è](../README.md)
